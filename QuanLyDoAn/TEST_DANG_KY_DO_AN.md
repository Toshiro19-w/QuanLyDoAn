# H??NG D?N TEST QUY TRÌNH ??NG KÝ ?? ÁN

## ?? SETUP TEST

### Chu?n b? d? li?u test
Ch?c ch?n b?n có:
- ? 1 tài kho?n Gi?ng viên (VD: gv_test / pass123)
- ? Ít nh?t 2 tài kho?n Sinh viên (VD: sv_test1 / pass123, sv_test2 / pass123)
- ? Database ?ã t?o b?ng YeuCauDangKy

---

## ?? TEST CASE 1: T?o ?? Tài M?i

### Test Case 1.1: Gi?ng viên t?o ?? tài thành công
```
B??c 1: ??ng nh?p v?i tài kho?n Gi?ng viên
B??c 2: Click "T?o ?? tài m?i"
B??c 3: Nh?p:
  - Mã ?? tài: DA_TEST_001
  - Tên ?? tài: H? th?ng qu?n lý bán hàng
  - Lo?i ?? án: (ch?n t? dropdown)
  - K? h?c: (ch?n t? dropdown)
  - Chuyên ngành: (ch?n t? dropdown)
  - Tr?ng thái: (ch?n t? dropdown)
  - Ngày b?t ??u: 01/01/2025
  - Ngày k?t thúc: 30/06/2025
B??c 4: Click "L?u"

? K? V?NG:
  - Hi?n th? "T?o ?? án thành công!"
  - Ki?m tra DB: DoAn.MaSV = NULL
```

### Test Case 1.2: Sinh viên không th? t?o ?? tài
```
B??c 1: ??ng nh?p v?i tài kho?n Sinh viên
B??c 2: Click "T?o ?? tài m?i"

? K? V?NG:
  - Form hi?n th? l?i: "Ch? gi?ng viên m?i có th? t?o ?? tài m?i!"
```

---

## ?? TEST CASE 2: Sinh Viên ??ng Ký ?? Tài

### Test Case 2.1: Sinh viên thành công ??ng ký
```
B??c 1: ??ng nh?p v?i tài kho?n Sinh viên #1
B??c 2: Click "??ng ký ?? án"
B??c 3: Ch?n ?? tài DA_TEST_001
B??c 4: (Tùy ch?n) Nh?p ghi chú: "Tôi mu?n làm ?? tài này"
B??c 5: Click "??ng ký"

? K? V?NG:
  - Hi?n th?: "G?i yêu c?u ??ng ký thành công!"
  - Ki?m tra DB: 
    - YeuCauDangKy.TrangThai = "Pending"
    - YeuCauDangKy.MaSV = sv_test1
    - YeuCauDangKy.MaDeTai = DA_TEST_001
```

### Test Case 2.2: Sinh viên khác c?ng ??ng ký
```
B??c 1: ??ng nh?p v?i tài kho?n Sinh viên #2
B??c 2: Click "??ng ký ?? án"
B??c 3: Ch?n ?? tài DA_TEST_001 (cùng ?? tài)
B??c 4: Click "??ng ký"

? K? V?NG:
  - G?i thành công (2 yêu c?u cho cùng 1 ?? tài)
  - Ki?m tra DB: 2 b?n ghi trong YeuCauDangKy ??u Pending
```

### Test Case 2.3: Sinh viên g?i yêu c?u trùng
```
B??c 1: V?n ??ng nh?p Sinh viên #1
B??c 2: Click "??ng ký ?? án"
B??c 3: Ch?n l?i DA_TEST_001 (?? tài v?a ??ng ký)
B??c 4: Click "??ng ký" l?n n?a

? K? V?NG:
  - Hi?n th? c?nh báo: "B?n ?ã g?i yêu c?u cho ?? tài này r?i"
  - KHÔNG g?i ???c (v?n ch? 1 yêu c?u trong DB)
```

---

## ? TEST CASE 3: Gi?ng Viên Duy?t Yêu C?u

### Test Case 3.1: GV duy?t - Ch?p nh?n
```
B??c 1: ??ng nh?p v?i tài kho?n Gi?ng viên
B??c 2: Click "Duy?t yêu c?u"
B??c 3: S? th?y danh sách:
  - Yêu c?u #1: Sinh viên #1 - DA_TEST_001 - Pending
  - Yêu c?u #2: Sinh viên #2 - DA_TEST_001 - Pending
B??c 4: Ch?n Yêu c?u #1 (Sinh viên #1)
B??c 5: Click "Ch?p nh?n"
B??c 6: Xác nh?n "Yes"

? K? V?NG:
  - Hi?n th?: "?ã ch?p nh?n yêu c?u! ... ?? tài s? bi?n m?t"
  - Danh sách yêu c?u:
    ? Yêu c?u #1 BI?N M?T (Approved)
    ? Yêu c?u #2 CÒN L?I nh?ng TrangThai = "Rejected" (không hi?n th? vì không Pending)
  - Ki?m tra DB:
    - DoAn.MaSV = sv_test1 (Sinh viên #1)
    - YeuCauDangKy[1].TrangThai = "Approved"
    - YeuCauDangKy[2].TrangThai = "Rejected"
```

### Test Case 3.2: Sinh viên #2 không th?y ?? tài
```
B??c 1: ??ng nh?p v?i Sinh viên #2
B??c 2: Click "??ng ký ?? án"

? K? V?NG:
  - DA_TEST_001 KHÔNG HI?N TH? (vì MaSV = sv_test1 ? NULL)
  - Ch? th?y nh?ng ?? tài khác ch?a có sinh viên
```

### Test Case 3.3: Sinh viên #1 không th?y ?? tài
```
B??c 1: ??ng nh?p v?i Sinh viên #1
B??c 2: Click "??ng ký ?? án"

? K? V?NG:
  - DA_TEST_001 KHÔNG HI?N TH? (?ã ???c gán cho SV #1)
  - (Tùy ch?n) Có th? thêm thông báo: "B?n ?ã có ?? tài r?i"
```

### Test Case 3.4: GV t? ch?i yêu c?u
```
B??c 1: T?o ?? tài m?i: DA_TEST_002
B??c 2: SV #1 ??ng ký DA_TEST_002
B??c 3: SV #2 ??ng ký DA_TEST_002
B??c 4: GV ??ng nh?p và duy?t yêu c?u
B??c 5: Ch?n Yêu c?u c?a SV #2
B??c 6: Click "T? Ch?i"

? K? V?NG:
  - Hi?n th?: "?ã t? ch?i yêu c?u!"
  - Danh sách yêu c?u:
    ? SV #2 b? xóa kh?i danh sách (TrangThai = "Rejected")
    ? SV #1 v?n còn Pending
  - Ki?m tra DB:
    - DoAn.MaSV = NULL (ch?a gán ai)
    - SV #1 yêu c?u v?n Pending
    - SV #2 yêu c?u = Rejected
```

---

## ?? TEST CASE 4: TH?NG KÊ & KI?M TRA

### Test Case 4.1: Ch?y SQL queries
```sql
-- Ki?m tra t?t c? Pending requests
SELECT * FROM YeuCauDangKy WHERE TrangThai = 'Pending';

-- Ki?m tra DoAn ch?a có sinh viên
SELECT * FROM DoAn WHERE MaSV IS NULL;

-- Ki?m tra DoAn ?ã có sinh viên
SELECT * FROM DoAn WHERE MaSV IS NOT NULL;
```

### Test Case 4.2: Ki?m tra quy?n h?n
```
Test Admin:
? Không th? t?o ?? tài
? Không th? duy?t yêu c?u
? Không th? ??ng ký ?? tài

Test GiangVien:
? Có th? t?o ?? tài
? Có th? duy?t yêu c?u
? Không th? ??ng ký ?? tài

Test SinhVien:
? Không th? t?o ?? tài
? Không th? duy?t yêu c?u
? Có th? ??ng ký ?? tài
```

---

## ?? TROUBLESHOOTING

### V?n ?? 1: Không th?y nút "??ng ký ?? án"
```
Ki?m tra:
1. ?ã ??ng nh?p v?i tài kho?n Sinh viên?
2. Role SinhVien có ?úng không?
3. AuthorizationHelper.IsSinhVien() tr? v? true?
```

### V?n ?? 2: ?? tài v?n hi?n th? sau khi duy?t
```
Ki?m tra:
1. Sau khi GV ch?p nh?n, MaSV có ???c set không?
2. Ch?y: SELECT * FROM DoAn WHERE MaDeTai = 'DA_TEST_001'
3. N?u MaSV v?n NULL ? Ki?m tra logic DuyetYeuCau()
```

### V?n ?? 3: Yêu c?u khác không b? t? ch?i
```
Ki?m tra:
1. Ch?y: SELECT * FROM YeuCauDangKy WHERE MaDeTai = 'DA_TEST_001'
2. N?u t?t c? v?n Pending ? Ki?m tra logic DuyetYeuCau()
3. Ch?c ch?n có dòng: req.TrangThai = "Rejected";
```

### V?n ?? 4: Database error
```
Ki?m tra:
1. B?ng YeuCauDangKy t?n t?i?
2. Foreign key ???c thi?t l?p ?úng?
3. Ch?y: CREATE TABLE YeuCauDangKy (...) t? script SQL
```

---

## ?? QUICK CHECKLIST

- [ ] Database b?ng YeuCauDangKy ?ã t?o
- [ ] Tài kho?n test (GV + 2 SV) ?ã s?n
- [ ] Build project thành công
- [ ] Ch?y MainForm.cs
- [ ] Test Case 1: GV t?o ?? tài ?
- [ ] Test Case 2: SV ??ng ký ?
- [ ] Test Case 3: GV duy?t ?
- [ ] Test Case 4: Ki?m tra DB ?
- [ ] Ki?m tra quy?n h?n ?
- [ ] ? Xong!

---

## ?? LIÊN H? & SUPPORT

N?u có l?i:
1. Xem messages trong Output window
2. Ch?y SQL queries ?? ki?m tra d? li?u
3. Debug t?ng method trong DangKyDoAnController.cs
